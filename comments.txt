Привет, Артём!

Спасибо за твоё развёрнутое ревью, несколько твоих советов мне сильно помогли :-)
Еще раз извиняюсь за недоделанный в прошлый раз проект, в этот раз вроде бы всё на месте.


Артём, спасибо за ревью!
В users_locations учёт первого города я поправил.

В geo_zones_stats насчет первого замечания. Вот ответ преподавателя по количеству регистраций:
Виталий Гречко [преподаватель]
"@andreibazhenau Количество регистраций - это количество уникальных пользователей за период
(неделя или месяц), вобщем количетсво уникальных message_from"
Исходя из этой рекомендации, я для каждого месяца и каждой недели находил первое сообщение
от пользователя в месяце и неделе, учитывая дату сообщения.
Таким образом если мы считаем агрегаты: groupBy("month").agg(sum("week_user"), sum("month_user"))
Должны корректно посчитаться уникальные пользователи как за месяц, так и по недельно.
Плюс corner case-ы когда неделя выпадает на разные месяцы должны корректно отрабатывать.
Опираясь на эту логику и ответы преподавателя, я считал и количество событий (второе замечание по зонам).

Андрей Баженов
08:22
@grechkov Виталий, добрый день. Здесь немного не понятно за какой перид считать витрину. Например если мы берем дату
последнего дня месяца, то мы посчитаем статистику полную за месяц, но по неделям у нас могут полуиться первая и
последняя неделя обрезанные, т.к. они полностью не попадают в месяц. И тогда, например по месяцам статистику удобно
получаться, а вот по неделе конкретной придется всегда делать агрегат, что бы получить полную картину, т.к. статистика
может попасть в два разных месяца (начало недели в один месяц, а конец в другой.)
И как часто вообще считать статистику и за какой период? Вообще здесь по-идее должно быть две ветриты: одна по неделям,
вторая по месяцам и тогда не было бы никаких проблем. Одну считаем раз в месяц, другую раз в неделю.

Виталий Гречко [преподаватель]
17:37
@andreibazhenau Добрый день Андрей. Согласен, агрегаты по неделям не будут соответствовать месяцам, но это и нормально.
Витрина действительно одна, можно было бы сделать две. Но одна витрина также полезна, потому что будет всегда
расчитываться Month-To-Date, т.е. аггрегат по последнему месяцу до текущей даты

